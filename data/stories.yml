version: "3.1"

stories:

- story: User orders a pizza via pizza form
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_pizza_slots
  - checkpoint: user_orders_pizza
  
- story: User chooses take-away
  steps:
  - action: utter_ask_modality
  - intent: inform_about_modality
  - slot_was_set:
    - modality: take-away
  # il cliente sceglie "Take-away"
  - action: action_tell_pick_time
  # domanda per confermare l'orario
  - checkpoint: user_chooses_takeaway

- story: User chooses delivery
  steps:
  - action: utter_ask_modality
  - intent: inform_about_modality
  - slot_was_set:
    - modality: delivery
  # il cliente sceglie "Delivery" -> delivery form
  - action: delivery_form
  - active_loop: delivery_form
  - slot_was_set:
    - requested_slot: address
    - requested_slot: number_address
    - requested_slot: phone
    - requested_slot: doorbell
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - checkpoint: user_chooses_delivery

#- story: User orders a pizza via pizza form
#  steps:
#  - intent: greet
#  - action: utter_info_about_pizzeria
#  - action: utter_greet
#  - intent: buy_pizza
#  - action: simple_pizza_form
#  - active_loop: simple_pizza_form
#  - slot_was_set:
#    - requested_slot: pizza_type
#  - action: utter_ask_pizza_type
#  - intent: inform_about_pizza
#  - slot_was_set:
#    - pizza_type
  #- action: simple_pizza_form
#  - slot_was_set:
#    - requested_slot: pizza_size
#  - action: utter_ask_pizza_size
#  - intent: inform_about_pizza
#  - slot_was_set:
#    - pizza_size
#  - slot_was_set:
#    - requested_slot: null
#  - active_loop: null
#  - action: utter_submit
#  - action: action_pizza_slots

- story: User asks info about available pizzas and pizza's sizes
  steps:
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  # ask info about pizzas
  - intent: ask_info_pizza
  - action: action_info_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  # Ask info about pizza's sizes
  - intent: ask_info_pizza_size
  - action: action_info_pizza_size
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_pizza_slots

- story: User interrupts asking info about assistant's identity (if it's a bot) and stops the form
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - intent: bot_challenge
  - action: utter_iamabot
  - action: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - intent: stop
  - action: utter_ask_stop
  - intent: affirm
  - action: utter_confirm
  - action: action_deactivate_loop
  - action: action_reset_all_slots
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_order
  - intent: deny
  - action: utter_confirm
  - action: action_recap_order
  - intent: goodbye
  - action: utter_goodbye

- story: User interrupts asking info about assistant's identity (if it's a bot) and orders a pizza
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - intent: bot_challenge
  - action: utter_iamabot
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_pizza_slots
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
  #- or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
  #  - intent: deny
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  # il cliente ordina anche una bevanda
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_drink
  - action: action_change_drink
  - slot_was_set:
    - drink
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  # domanda per confermare l'ordine
  - intent: affirm
  - action: utter_confirm
  - action: action_tell_bill
  - action: utter_ask_modality
  - intent: inform_about_modality
#    entities:
#      - modality: "take-away"
#  - action: action_check_modality
  - slot_was_set:
    - modality: take-away
  # il cliente sceglie "Take-away"
  - action: action_tell_pick_time
  # domanda per confermare l'orario
  - intent: affirm
  - action: utter_confirm
  - slot_was_set:
    - requested_slot: order_time
  - slot_was_set:
    - requested_slot: ready_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User interrupts asking info about menu, orders a pizza
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - intent: ask_for_menu
  - action: action_tell_menu
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_pizza_slots
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  - action: utter_ask_topping
  #- or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
   # - intent: deny
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User wants to stop the form
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - intent: stop
  - action: utter_ask_stop
  - intent: affirm
  - action: utter_confirm
  - action: action_deactivate_loop
  - action: action_reset_all_slots
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_order
  - intent: deny
  - action: utter_confirm
  - action: action_recap_order
  - intent: goodbye
  - action: utter_goodbye

- story: User completes an order (take-away) 2
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
  #- or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
   # - intent: deny
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  # il cliente ordina anche una bevanda
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  # domanda per confermare l'ordine
  - intent: affirm
  - action: utter_confirm
  - action: action_tell_bill
  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
  - intent: inform_about_modality
#    entities:
#      - modality: "take-away"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
  - slot_was_set:
    - modality: take-away
  # il cliente sceglie "Take-away"
  - action: action_tell_pick_time
  # domanda per confermare l'orario
  - intent: affirm
  - action: utter_confirm
  - slot_was_set:
    - requested_slot: order_time
  - slot_was_set:
    - requested_slot: ready_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User completes an order (take-away) 2
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping
  # topping specificato nell'ordine (nel form) -- > check topping
  - action: action_check_topping
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  # il cliente ordina anche una bevanda
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  # domanda per confermare l'ordine
  - intent: affirm
  - action: utter_confirm
  - action: action_tell_bill
  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
  - intent: inform_about_modality
#    entities:
#      - modality: "take-away"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
  - slot_was_set:
    - modality: take-away
  # il cliente sceglie "Take-away"
  - action: action_tell_pick_time
  # domanda per confermare l'orario
  - intent: affirm
  - action: utter_confirm
  - slot_was_set:
    - requested_slot: order_time
  - slot_was_set:
    - requested_slot: ready_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User completes an order (delivery) 1
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
  #- or:
  #  - intent: inform_about_topping
  - intent: deny
  - action: utter_confirm
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  # il cliente ordina anche una bevanda
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_drink
  - action: action_change_drink
  - slot_was_set:
    - drink
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  # domanda per confermare l'ordine
  - intent: affirm
  - action: utter_confirm
  - action: action_tell_bill
  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
  - intent: inform_about_modality
#    entities:
#      - modality: "delivery"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
  - slot_was_set:
    - modality: delivery
  # il cliente sceglie "Delivery" -> delivery form
  - action: delivery_form
  - active_loop: delivery_form
  - slot_was_set:
    - requested_slot: address
    - requested_slot: number_address
    - requested_slot: phone
    - requested_slot: doorbell
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_recap_delivery
  # Domanda per confermare i dati per la consegna
  - intent: affirm
  - action: utter_confirm
  - action: action_calc_delivery_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User completes an order (delivery) 2
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping
  # topping specificato nell'ordine (nel form) -- > check topping
  - action: action_check_topping
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  # il cliente ordina anche una bevanda
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  # domanda per confermare l'ordine
  - intent: affirm
  - action: utter_confirm
  - action: action_tell_bill
  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
  - intent: inform_about_modality
#    entities:
#      - modality: "delivery"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
  - slot_was_set:
    - modality: delivery
  # il cliente sceglie "Delivery" -> delivery form
  - action: delivery_form
  - active_loop: delivery_form
  - slot_was_set:
    - requested_slot: address
    - requested_slot: number_address
    - requested_slot: phone
    - requested_slot: doorbell
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_recap_delivery
  # Domanda per confermare i dati per la consegna
  - intent: affirm
  - action: utter_confirm
  - action: action_calc_delivery_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User orders only a pizza (delivery)
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
  #- intent: deny
  #- or:
   # - intent: inform_about_topping
  - intent: deny
  - action: utter_confirm
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  # domanda per confermare l'ordine
  - intent: affirm
  - action: utter_confirm
  - action: action_tell_bill
  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
  - intent: inform_about_modality
#    entities:
#      - modality: "delivery"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
  - slot_was_set:
    - modality: delivery
  # il cliente sceglie "Delivery" -> delivery form
  - action: delivery_form
  - active_loop: delivery_form
  - slot_was_set:
    - requested_slot: address
    - requested_slot: number_address
    - requested_slot: phone
    - requested_slot: doorbell
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_recap_delivery
  # Domanda per confermare i dati per la consegna
  - intent: affirm
  - action: utter_confirm
  - action: action_calc_delivery_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye  

- story: User orders a drink
  steps:
  - action: utter_other_service
  # il cliente ordina anche una bevanda
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User orders a drink, fails and ask again
  steps:
  - slot_was_set:
    - drink: null
  # il cliente ha ordinato una bevanda inesistente
  - action: utter_ask_drink
  # il cliente ordina di nuovo una bevanda
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare la bevanda ordinata
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User doesn't have any requests
  steps:
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  # domanda per confermare l'ordine
  - intent: affirm
  - action: utter_confirm
  - action: action_tell_bill
  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality

- story: User changes the pizza ordered after the final recap
  steps:
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_pizza
  - action: action_change_pizza
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
    - pizza_topping
  # topping specificato nell'ordine (nel form) -- > check topping
  - action: action_check_topping
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User changes the topping ordered after the final recap
  steps:
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_topping
  - action: action_change_topping
  - action: utter_other_service

- story: User changes the drink ordered after the final recap
  steps:
  - slot_was_set:
    - drink
  - action: utter_other_service
  - intent: deny
  - action: utter_confirm
  # il cliente non vuole più effettuare nessun tipo di ordine
  - action: action_recap_order
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_drink
  - action: action_change_drink
  - slot_was_set:
    - drink
  - action: utter_other_service
  
- story: User asks infos about available toppings
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
    - pizza_topping: null
  - action: utter_ask_topping
  - intent: ask_info_toppings
  - action: action_info_toppings
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
  #- intent: deny
  #- or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
   # - intent: deny
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  
- story: User asks infos about available drinks and orders a drink
  steps:
  - action: utter_other_service
  # il cliente chiede info sulle bevande
  - intent: ask_for_drink
  - action: action_info_drinks
  - slot_was_set:
    - drink: null
  - action: utter_ask_drink
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare la bevanda ordinata
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User asks infos about available drinks but doesn't orders a drink
  steps:
  - action: utter_other_service
  # il cliente chiede info sulle bevande
  - intent: ask_for_drink
  - action: action_info_drinks
  - slot_was_set:
    - drink: null
  - action: utter_ask_drink
  - intent: deny
  - action: utter_confirm
  - action: utter_other_service

- story: User asks for the bill
  steps:
  - action: utter_other_service
  - intent: ask_for_bill
  - action: action_tell_bill
  - action: utter_other_service

- story: User changes pizza (user driven)
  steps:
  - checkpoint: user_orders_pizza
  - intent: change_pizza
  - action: action_change_pizza
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  - action: utter_ask_topping
  #- or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
   # - intent: deny
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User changes pizza (bot driven)
  steps:
  - checkpoint: user_orders_pizza
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_pizza
  - action: action_change_pizza
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  - action: utter_ask_topping
  #- or:
   # - intent: inform_about_topping
  - intent: deny
  - action: utter_confirm
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_topping
  - action: action_change_topping
  - action: utter_other_service

- story: User changes topping (specified out of form) (user driven)
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
  #- or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
   # - intent: deny
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: change_topping
  - action: action_change_topping
  - action: utter_other_service

- story: User changes topping (specified out of form) (bot driven)
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  #- slot_was_set:
  #  - pizza_topping: null
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
  #- or:
 #   - intent: inform_about_topping
  - intent: deny
  - action: utter_confirm
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_topping
  - action: action_change_topping
  - action: utter_other_service

- story: User changes topping (specified in the form) (user driven)
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping
  # topping specificato nell'ordine (nel form) -- > check topping
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: change_topping
  - action: action_change_topping
  - action: utter_other_service

- story: User changes topping (specified in the form) (bot driven)
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping
  # topping specificato nell'ordine (nel form) -- > check topping
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_topping
  - action: action_change_topping
  - action: utter_other_service

- story: User adds topping but fails
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  #- slot_was_set:
  #  - pizza_topping: null
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
 # - or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
  #  - intent: deny
  - action: action_check_topping
  # cliente fornisce topping sbagliato, richiesta la domanda
  #- action: utter_ask_topping
  #- or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
 #   - intent: deny
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User changes drink (user driven)
  steps:
  - action: utter_other_service
  # il cliente ordina anche una bevanda
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: change_drink
  - action: action_change_drink
  - slot_was_set:
    - drink
  - action: utter_other_service

- story: User changes drink (bot driven)
  steps:
  - action: utter_other_service
  # il cliente ordina anche una bevanda
  - intent: inform_about_drink
  - slot_was_set:
      - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: change_drink
  - action: action_change_drink
  - slot_was_set:
    - drink
  - action: utter_other_service

- story: User changes drink but fails
  steps:
  # cliente richiede un drink inesistente
  - slot_was_set:
    - drink: null
  - action: utter_ask_drink
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  # domanda per confermare il drink
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User chooses take-away
  steps:
  - checkpoint: user_chooses_takeaway
#  - slot_was_set:
#    - requested_slot: modality
#  - slot_was_set:
#    - modality: "take-away"
  # il cliente sceglie "Take-away"
#  - action: action_tell_pick_time
  # domanda per confermare l'orario
  - intent: affirm
  - action: utter_confirm
  - slot_was_set:
    - requested_slot: order_time
  - slot_was_set:
    - requested_slot: ready_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User chooses delivery
  steps:
  - checkpoint: user_chooses_delivery
#  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
#  - intent: inform_about_modality
#    entities:
#      - modality: "delivery"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
#  - slot_was_set:
#    - modality: "delivery"
  # il cliente sceglie "Delivery" -> delivery form
#  - action: delivery_form
#  - active_loop: delivery_form
#  - slot_was_set:
#    - requested_slot: address
#    - requested_slot: number_address
#    - requested_slot: phone
#    - requested_slot: doorbell
#  - slot_was_set:
#    - requested_slot: null
#  - active_loop: null
#  - action: utter_submit
  - action: action_recap_delivery
  - intent: affirm
  - action: utter_confirm
  - action: action_calc_delivery_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User chooses delivery (one slot per time)
  steps:
  - action: utter_ask_modality
  - intent: inform_about_modality
  - slot_was_set:
    - modality: delivery
  - action: delivery_form
  - active_loop: delivery_form
  - slot_was_set:
    - requested_slot: address
  - intent: inform_about_address
  - slot_was_set:
    - address
  - action: delivery_form
  - slot_was_set:
    - requested_slot: number_address
  - intent: inform_about_nr_address
  - slot_was_set:
    - address
  - action: delivery_form
  - slot_was_set:
    - requested_slot: phone
  - intent: inform_about_phone
  - slot_was_set:
    - phone
  - action: delivery_form
  - slot_was_set:
    - requested_slot: doorbell
  - intent: inform_about_doorbell
  - slot_was_set:
    - doorbell
  - action: delivery_form
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_recap_delivery


- story: User changes pick-up time (user driven)
  steps:
  - checkpoint: user_chooses_takeaway
#  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
#  - intent: inform_about_modality
#    entities:
#      - modality: "take-away"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
#  - slot_was_set:
#    - modality: "take-away"
  # il cliente sceglie "Take-away"
#  - action: action_tell_pick_time
  # domanda per confermare l'orario
  - intent: ask_specific_time
  - action: action_check_pick_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User changes pick-up time (bot driven)
  steps:
  - checkpoint: user_chooses_takeaway
#  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
#  - intent: inform_about_modality
#    entities:
#      - modality: "take-away"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
#  - slot_was_set:
#    - modality: "take-away"
  # il cliente sceglie "Take-away"
#  - action: action_tell_pick_time
  # domanda per confermare l'orario
  - intent: deny
  - action: utter_confirm
  - action: action_ask_type_change
  - intent: ask_specific_time
  - action: action_check_pick_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User changes delivery info
  steps:
  - checkpoint: user_chooses_delivery
#  - action: utter_ask_modality
#  - slot_was_set:
#    - requested_slot: modality
#  - intent: inform_about_modality
#    entities:
#      - modality: "delivery"
#  - action: action_check_modality
#  - slot_was_set:
#    - requested_slot: modality
#  - slot_was_set:
#    - modality: "delivery"
  # il cliente sceglie "Delivery" -> delivery form
#  - action: delivery_form
#  - active_loop: delivery_form
#  - slot_was_set:
#    - requested_slot: address
#    - requested_slot: number_address
#    - requested_slot: phone
#    - requested_slot: doorbell
#  - slot_was_set:
#    - requested_slot: null
#  - active_loop: null
#  - action: utter_submit
  - action: action_recap_delivery
  # Domanda per confermare i dati per la consegna
  - intent: change_delivery
  - action: action_change_delivery
  - action: delivery_form
  - active_loop: delivery_form
  - slot_was_set:
    - requested_slot: address
    - requested_slot: number_address
    - requested_slot: phone
    - requested_slot: doorbell
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_recap_delivery
  # Domanda per confermare i dati per la consegna
  - intent: affirm
  - action: utter_confirm
  - action: action_calc_delivery_time
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye

- story: User adds a topping and then removes it from order
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  #- slot_was_set:
  #  - pizza_topping: null
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  # topping non specificato nell'ordine (nel form) -- > ask for topping
  - action: utter_ask_topping
  #- or:
  - intent: inform_about_topping
  - slot_was_set:
      - pizza_topping
  #- intent: deny
  - action: action_check_topping
  - intent: remove_from_order
  - action: action_remove_from_order
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  - action: utter_ask_topping
  - intent: deny
  - action: utter_confirm
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User removes topping from order
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping
  # topping specificato nell'ordine (nel form) -- > check topping
  - action: action_check_topping
  - intent: remove_from_order
  - action: action_remove_from_order
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping: null
  - action: utter_ask_topping
  - intent: deny
  - action: utter_confirm
  - action: action_check_topping
  # domanda per confermare l'aggiunta
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service

- story: User removes drink from order
  steps:
  - action: utter_other_service
  - intent: inform_about_drink
  - slot_was_set:
    - drink
  - action: action_check_drink
  - intent: remove_from_order
  - action: action_remove_from_order
  - slot_was_set:
    - drink: null
  - action: utter_ask_drink
  - intent: deny
  - action: utter_confirm
  - action: utter_other_service

- story: User orders a pizza and then deletes it and restarts
  steps:
  - checkpoint: user_orders_pizza
  - intent: affirm
  - action: utter_confirm
  - action: action_ask_topping
#  - slot_was_set:
#    - requested_slot: pizza_topping
  - slot_was_set:
      - pizza_topping
  # topping specificato nell'ordine (nel form) -- > check topping
  - action: action_check_topping
  - intent: affirm
  - action: utter_confirm
  - action: utter_other_service
  - intent: delete_order
  - action: action_delete_order
  - action: utter_order
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_pizza_slots

- story: User deletes the order and restarts
  steps:
  - action: utter_other_service
  - intent: delete_order
  - action: action_delete_order
  - action: utter_order
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_pizza_slots

- story: User interrups the pizza form, deletes the order and repeat ordering (bot driven)
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - intent: delete_order
  - action: action_delete_order
  - action: action_deactivate_loop
  - action: action_reset_all_slots
  - action: utter_order
  - intent: affirm
  - action: utter_confirm
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_pizza_slots
  
- story: User interrups the pizza form, deletes the order and repeat ordering (user driven)
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - intent: delete_order
  - action: action_delete_order
  - action: action_deactivate_loop
  - action: action_reset_all_slots
  - action: utter_order
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_pizza_slots
  
  
- story: User interrups the pizza form, deletes the order and stop ordering
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: buy_pizza
    - intent: inform_about_pizza
  - action: simple_pizza_form
  - active_loop: simple_pizza_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_size
  - intent: delete_order
  - action: action_delete_order
  - action: action_deactivate_loop
  - action: action_reset_all_slots
  - action: utter_order
  - intent: deny
  - action: utter_confirm
  - action: action_recap_order
  - intent: goodbye
  - action: utter_goodbye

- story: Employee logins
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - intent: stock_data
  - action: login_form
  - active_loop: login_form
  - slot_was_set:
    - requested_slot: id
  - slot_was_set:
    - requested_slot: password
  - slot_was_set:
    - is_logged: true
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_login_slots
  - checkpoint: employee_login

- story: Unlogged employee tries to order ingredient
  steps:
  - intent: greet
  - action: utter_info_about_pizzeria
  - action: utter_greet
  - or:
    - intent: order_ingredient
    - intent: stock_data
    - intent: ask_stock_topping
    - intent: ask_ingredients_to_order
  - action: login_form
  - active_loop: login_form
  - slot_was_set:
    - requested_slot: id
  - slot_was_set:
    - requested_slot: password
  - slot_was_set:
    - is_logged: true
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit
  - action: action_login_slots
  - action: utter_ask_service

- story: Employee asks info about stock
  steps:
  - checkpoint: employee_login
  - action: utter_ask_service
  - intent: ask_stock_topping
  - action: query_topping_quantity
  - action: utter_ask_service

- story: Employee orders ingredients by providing the quantity
  steps:
  - checkpoint: employee_login
  - action: utter_ask_service
  - intent: order_ingredient
  - action: action_order_ingredient
  - intent: affirm
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_service

- story: Employee changes the order providing another order (bot driven)
  steps:
  - checkpoint: employee_login
  - action: utter_ask_service
  - intent: order_ingredient
  - action: action_order_ingredient
  - intent: deny
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_order
  - intent: affirm
  - action: utter_confirm
  - action: utter_ask_ingredients
  - intent: order_ingredient
  - action: action_order_ingredient
  - intent: affirm
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_service
  - intent: deny
  - action: utter_confirm
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye
  
- story: Employee changes the order providing another order (employee driven)
  steps:
  - checkpoint: employee_login
  - action: utter_ask_service
  - intent: order_ingredient
  - action: action_order_ingredient
  - intent: deny
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_order
  - intent: order_ingredient
  - action: action_order_ingredient
  - intent: affirm
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_service

- story: Employee changes the order and doesn't order (bot driven)
  steps:
  - checkpoint: employee_login
  - action: utter_ask_service
  - intent: order_ingredient
  - action: action_order_ingredient
  - intent: deny
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_order
  - intent: deny
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_service
  - intent: deny
  - action: utter_confirm
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye
  
- story: Employee asks ingredients below ordering threshold and orders them (employee driven)
  steps:
  - checkpoint: employee_login
  - action: utter_ask_service
  - intent: ask_ingredients_to_order
  - action: action_say_ingredient_below_threshold
  - action: utter_ask_order
  - intent: order_ingredient
  - action: action_order_ingredient
  - intent: affirm
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_service

- story: Employee asks ingredients below ordering threshold and orders them (bot driven)
  steps:
  - checkpoint: employee_login
  - action: utter_ask_service
  - intent: ask_ingredients_to_order
  - action: action_say_ingredient_below_threshold
  - action: utter_ask_order
  - intent: affirm
  - action: utter_confirm
  - action: action_order_ingredients_below_threshold
  - action: utter_ask_service
  
- story: Employee asks ingredients below ordering threshold but doen't order them
  steps:
  - checkpoint: employee_login
  - action: utter_ask_service
  - intent: ask_ingredients_to_order
  - action: action_say_ingredient_below_threshold
  - action: utter_ask_order
  - intent: deny
  - action: utter_confirm
  - action: action_check_order_ingredient
  - action: utter_ask_service
  - intent: deny
  - action: utter_confirm
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye
  
- story: Employee doens't have any other requests
  steps:
  - action: utter_ask_service
  - intent: deny
  - action: utter_confirm
  - action: utter_next_time
  - intent: goodbye
  - action: utter_goodbye
